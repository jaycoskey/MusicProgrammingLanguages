<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<title>Music Programming Languages</title>
		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
	<meta name="author" content="Jay Coskey">
		<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

	<link rel="stylesheet" href="css/reveal.css">
	<link rel="stylesheet" href="css/white.css" id="theme">

	<!-- Code syntax highlighting -->
	<link rel="stylesheet" href="css/zenburn.css">

	<!-- Printing and PDF exports -->
	<script>
		var link = document.createElement( 'link' );
		link.rel = 'stylesheet';
		link.type = 'text/css';
		link.href = window.location.search.match( /print-pdf/gi ) ? 'css/pdf.css' : 'css/paper.css';
		document.getElementsByTagName( 'head' )[0].appendChild( link );
	</script>
	<script src="js/head.min.js"></script>
	<script src="js/reveal.js"></script>

	<!--[if lt IE 9]>
	<script src="lib/js/html5shiv.js"></script>
	<![endif]-->
</head>

<body>
<div class="reveal">
<!-- Any section element inside of this container is displayed as a slide -->
<div class="slides">

<section id="title">
		<h1>Music Programming Languages</h1>
		<h3>Creating and Analyzing Tonal Music and Soundscapes</h3>
		<p align="center">Jay Coskey</p>
		<p align="center">2016-05-04</p>
		<b>
		<pre style="background-color: #d0ffd0; font-size: 48px;">
  Use N or &lt;space&gt; to advance to the next slide.
  Use P to return to the previous slide.
  Use &lt;Esc&gt; to view an overview of all slides.
  Use ? to view a list of all keyboard commands.
		</pre>
		</b>
</section>

<section id="section_introduction">
	<section id="introduction">
		<h2 style="background-color: #d0d0ff;">
			<a href="#/title">&#x25c1;</a>
			Introduction
			<a href="#/euterpea">&#x25b7;</a>
		</h2>
		<em>
		"To play the wrong note is insignificant; to play without passion is inexcusable."
		</em>
		- Beethoven
		<br/><br/>
		<div style="text-align: left;">
		<b>Music runs long and deep through the human psyche:</b>
		<ul>
			<li> Music is universal and ancient:
			humans were carving flutes from bone
			<a href="http://news.nationalgeographic.com/news/2009/06/090624-bone-flute-oldest-instrument.html">
			40K years ago
			</a>.
			<li> Music has deep internal structures, and the psychology of music
				is not fully understood.
			<li> Movie music can turn a mediocre film into a great one,
				and opera music can bring people to tears.
		</ul>
		<br/><br/>
		<b>Music software provides an alternative to traditional music training:</b>
		<ul>
			<li> Traditional training (performance/composition) can take over a decade for mastery.
			<li> Can this be shortened if software is used as the instrument?
			<li> Is the maximum fluency achievable greater with software as the instrument?
		</ul>
		<br/><br/>
		<b>Music software can do some things formerly done only by humans:</b>
		<ul>
			<li> Software can detect similarities within a piece and within a corpus.
			<li> Feature extraction and machine learning can
				&mdash; with appropriate data &mdash;
				do a fair job at recognition of attributes such as instruments,
				genre, and mood.
			<li> Software can compose original music, with limited success.
			</ul>
		</ul>
		</div>
		<aside class="notes">
			Example: The
				<a href="http://en.wikipedia.org/wiki/Amen_break">
					Amen Break
				</a>
		</aside>
	</section>

	<section id="intro_tonal">
		<h3>Introduction &mdash; Tonal Music</h3>
		<div style="text-align: left;">
		Tonal music examples: "Greensleeves", "Mary Had a Little Lamb"
		<ul>
			<li> Acoustics, instruments, composition, play/record, visualization, psychology
			<li> Time domain: Rhythm
			<li> Freq domain: Temperament, scales, keys, chords
			<li> Time & Freq: Melodies, chord progressions, texture
			<li> Sheet music: Traditional western notation, and others lesser known
			<ul>
				<li> Scores, staves, measures, notes, accidentals, 
				<li>
			</ul>
			<li> Computer formats: MIDI, MusicXML, ABC, LilyPond, MusicTeX, etc.
			<li> Tools: Scorewriters (e.g., MuseScore, Finale, Sibelius)
		</ul>
		</div>
		<aside class="notes" />
	</section>

	<section id="intro_musicxml">
		<h3>Introduction &mdash; MusicXML</h3>
		<div style="text-align: left;">
		TODO: Add content
		</div>
		<aside class="notes" />
	</section>

	<section id="intro_soundscapes">
		<h3>Introduction &mdash; Soundscapes</h3>
		<div style="text-align: left;">
		Soundscape examples: The THX Sound Effect
		("<a href="https://www.youtube.com/watch?v=M3lO9Dt3kjA">Deep Sound</a>"), or the
		<a href="https://www.youtube.com/watch?v=-0tPBQddeJs">Futurama Theme</a>
		<ul>
			<li> Soundscapes are more amorphous than tonal music.
			<li> Most digital audio workstations (DAWs) are written in C++.
			<li> At a low level, sound can be represented by arrays of numbers,
				and the domain-specific language (DSL) for arrays of numbers
				has already been written: Fortran, back in 1957 by J. Backus,
				famous for Backus-Naur Form (BNF).
			<li> Tools: DAWs, FFTs
			<li> Most of this talk will focus on tonal music.
		</ul>
		</div>
		<aside class="notes">
		<ul>
			<li> Joke: Seven years after Jim Backus invented Fortran, he was stranded with
				six other castaways on Gilligan's Island.
			<li> The Futurama Theme is based on a trippy 1967 song called
				<a href="https://www.youtube.com/watch?v=AOqfWj0HqNE">
				Psyché Rock
				</a> by Pierre Henry.
		</ul>
		</aside>
	</section>

	<section id="intro_music_data_mining">
		<h3> Introduction &mdash; Music data mining</h3>
		<div style="text-align: left;">
		<ul>
			<li> Music corpora (e.g., Wikifonia), compression, storage, indexing, tagging
			<li> Assisted and autonomous composition, including stochastic systems
			<li> Generations of chords from melody (e.g., using HMMs)
			<li> Instrument, artist, genre, mood identification (using signal processing)
			<li> Measuring song similarity (e.g., copyright infringement), incl. phrase identification
			<li> Song search (incl. search by humming), song recommendations
		</ul>
		</div>
		<aside class="notes" />
	</section>

	<section id="intro_math">
		<h3>Introduction &mdash; Mathematical Music Theory</h3>
		<div style="text-align: left;">
		<ul>
			<li> Hugo Riemann (1849-1919) was a German music theorist and composer
				who studied the transformations that can be made to three-note chords
				in order to better understand chord progressions.
			<ul>
				<li> A <em>Schritt</em> transposes one chord (i.e., shifts its frequency).
				<li> A <em>Wechsel</em> changed a major triad into a minor triad and vice versa.
			</ul>
			<li> This was later generalized to the P, L, and R operations
				in "Neo-Riemannian Theory", and the subjective field of "Schenkerian analysis",
				by Heinrich Schenker (1868-1935).
			<li> More recent work:
			<ul>
				<li> Transformational theory, by David Lewin, 1980s.
				<li> Generalized Contextual Groups (extension of the PLR group), by Fiore and Satyendra, 2005.
				<li> Uniform Triadic Transformations UTTs, by Julian ("Jay") Hook, 2002.
			</ul>
		</ul>
		<br/><br/>
		So what?  Any of these should be judged on their usefulness, not in answering the questions
		that they pose, but in answering questions outside of their scope.
		</div>
		<aside class="notes">
			<ul>
			<li> Hugo Riemann should not be confused with the mathematician/geometer Bernhard Riemann.
			<li> In Star Trek: The Next Generation, season 3, episode 9, Wesley Crusher was studying
				"a locally Euclidian metrization of a k-fold contravariant Riemannian tensor field".
				That's a different Riemann than Hugo Riemann.
			</ul>
		<aside>
	</section>

	<section id="intro_languages">
		<h3>Music Programming Languages</h3>
		<div style="text-align: left;">
		<ul>
			<li> There are over 100 music-related programming “languages”
			<ul>
				<li> Most are transcription-oriented.  Think HTML, but for music.
				<li> Soundscape DSLs came first ...
				<li> ... but now most center around melodic music.
			</ul>
			<li> Some Music Programming Languages:
			<ul>
				<li> ChucK        — RT synthesis, live coding, pedagogy, acoustic research, algo composition
				<li> Csound        — RTperformance, sound synth, algorithmic composition, acoustic research
				<li> MUSIC-N        — A very early music DSL
				<li> Pure Data (Pd)    — RT audio+video synthesis, like Max/MSP in the “Patcher” family
				<li> Strasheela (→‘12) — Constraint-based composition, based on the Oz language
				<li> SuperCollider (SC) — RT synthesis, live coding, algorithmic composition, acoustic research
				<ul>
					<li> Overtone    — A toolkit w/ a Closure API to SC and the compositional library “Leipzig”
					<li> Skoarcy    — A toolset in Skoar, a high-level music composition DSL that runs on SC
				</ul>
			</ul>
		<ul>
		</div>
		<aside class="notes" />
	</section>
</section>

<section id="section_transcription">
	<section id="transcription">
		<h2 style="background-color: #d0d0ff;">
			<a href="#/section_introduction">&#x25c1;</a>
			Song Transcription Languages
			<a href="#/section_euterpea">&#x25b7;</a>
		</h2>
		<div style="text-align: left;">
		Some simple music programming languages don't support variables or loops,
			so they can't support any of the more complex use cases.
		<br/><br/>
		But they can be good for representing scores in song databases.  Here's a brief taste.
		<ul>
			<li> ABC notation (v2.1 - Dec 2011) is a concise, popular, and well-supported
				<pre style="font-size: 32px; white-space: pre-line;">
				T:Mary had a little lamb
				M:C		% meter
				L:1/4   % basic note length
				K:F		% key
				AGFG|AAA2|GGG2|AAA2|
				AGFG|AAAA|GGAG|F4|]
				</pre>
			<li> LilyPond is useful for printing scores.
				<pre style="font-size: 32px; white-space: pre-line;">
				song = \relative c' {
					\clef treble
					\key c \major
					\time 4/4
					e4 d c d e e e2 d4 d d2 e4 e e2
					e4 d c d e e e c d d e d c2 r2
				}
				\score { \new Staff \song }
				</pre>
			<li> MusicTeX is also available to add scores into TeX documents.
		</ul>
		</div>
		<aside class="notes" />
	</section>
</section>

<section id="section_euterpea">
	<section id="euterpea">
		<h2 style="background-color: #d0d0ff;">
			<a href="#/section_transcription">&#x25c1;</a>
			Euterpea2
			<a href="#/section_csound">&#x25b7;</a>
		</h2>
		<div style="text-align: left;">
		<ul>
			<li> Euterpea (v2) is not strictly speaking a music programming language.
			<li> It's a Haskell library that's a good starting point for better
					understanding the domain of tonal and full-spectrum music.
			<li> Euterpea (and a related library and PDF called
				The Haskell School of Music) was written by the late Paul Hudak,
				together with
					Hai ("Paul") Liu,
					Eric Cheng,
					Donya Quick, and
					Daniel Winograd-Cort.
			<li> It's now maintained by the last two, Quick and Winograd-Cort.
		</div>
		<aside class="notes" />
	</section>

	<section id="euterpea_geting_started">
		<h2>Euterpea &mdash; Getting Started</h2>
		<div style="text-align: left;">
		<h4>Haskell School of Music</h4>
		<ul>
			<li> Download the PDF "Haskell School of Music" (HSoM.pdf).  (Could also serve as intro to Haskell.)
			<li> Can be thought of as a follow-on to Paul Hudak's "The Haskell School of Expression" (2000).
		</ul>
		<br><br>
		<h4>Installation</h4>
		<ul>
			<li>Read installation instructions at  <a href="http://www.euterpea.com/download-and-installation/">http://www.euterpea.com/download-and-installation/</a>
			<li>Install the 32-bit version of Haskell Platform.  (Sound doesn't work w/ 64-bit version.)
			<li>Install Euterpea2 and the Haskell School of Music (HSoM) from github.
			<li>Test installation ("MUI" = "Musical User Interface)
				<pre style="font-size: 32px; white-space: pre-line;">
					% ghci
					ghci> import Euterpea
					ghci> play $ c 4 qn  -- Play a quarter note, with sensible defaults
					ghci> import HSoM
					ghci> :load  HSoM.Examples.MUIExamples2
					ghci> import HSoM.Examples.MUIExamples2
					ghci> bifurcate     -- GUI app/test that lives in MUIExamples2
				</pre>
		</ul>
		</div>
		<aside class="notes">
			Euterpea is currently maintained by Donya Quick and Dan Winograd-Cort.
		</aside>
	</section>

	<section id="euterpea_model">
		<h3>Euterpea &mdash; Modeling (Tonal) Music</h3>
		<div style="text-align: left;">
		At the heart of Euterpea's representation of music is the following Primitive:
		<pre style="font-size: 32px;">
		data Primitive = Note Dur Pitch
			       | Rest Dur
		</pre>
		Type "Music" consists of Primitive events glued together
			sequentially (w/ operator :+:)
			or in parallel (with operator :=:),
			or tagged with some contextual control information.
		<pre style="font-size: 32px;">
data Music a = Prim (Primitive a)       -- primitive value
	     | Music a :+: Music a      -- sequential composition
	     | Music a :=: Music a      -- parallel composition
	     | Modify Control (Music a) -- modifier
		</pre>
		So the different constructors of Music are Prim, (:+:), (:=:),
		and Modify. 

		A function "play" uses defaults to perform some conversions:
		<pre style="font-size: 32px; white-space: pre-line;">
			Music ==> to Music1 (non-parameterized) ==> [MEvent] ==> [MidiMessage]
		</pre>
		The final MidiMessage list is then sent to a MIDI output.
		</div>
		<aside class="notes">
		</aside>
	</section>

	<section id="euterpea_frerejacques">
	<h3>Euterpea &mdash; Fr&#x00c8;re Jacques</h3>
		<div style="text-align: left;">
			To play one or a few simple notes:
			<pre style="font-size: 32px;">
	import Euterpea
	c :: Octave -> Dur -> Music Pitch
	play $ c 4 qn
	mapM (\octave -> play $ c octave qn) [0 .. 8]  -- Play C notes.
			</pre>
			Here’s something slightly more complex: a basic version of Frère Jacques.

			<pre style="font-size: 32px; white-space: pre-line;" font-family="family-name:cursive;">
			twice m = m :+: m
			fj1, fj2, fj3, fj4, fjNotes, fj :: Music Pitch
			fj1 = c 4 qn :+: d 4 qn :+: e 4 qn :+: c 4 qn
			fj2 = e 4 qn :+: f 4 qn :+: g 4 hn
			fj3 = g 4 en :+: a 4 en :+: g 4 en :+: f 4 en :+: e 4 qn :+: c 4 qn
			fj4 = c 4 qn :+: g 3 qn :+: c 4 hn
			fjNotes = twice fj1 :+: twice fj2 :+: twice fj3 :+: twice fj4
			fj = Modify (Tempo 4) $ Modify (Instrument AcousticGrandPiano) fjNotes

			play :: Performable a => Music a -> IO ()
			play fj
			</pre>
		</div>
		<aside class="notes">
			Converting Frère Jacques to a round is left as an exercise.
		</aside>
	</section>

	<section id="euterpea_performance">
		<h3>Euterpea &mdash; Creating a Performance</h3>
		<div style="text-align: left;">
		If we replace play with a more explicit version
		<pre style="font-size: 32px; " font-family="family-name:cursive;">
playA :: (ToMusic1 a, Control.DeepSeq.NFData a)
		=> PMap Note1 -> Context Note1 -> Music a -> IO()
		</pre>
		then we need to supply some more information,
		such as how to interpret note attributes (e.g., Pizzicato)
		and phrase attributes (e.g., Crescendo).
		<pre style="font-size: 32px;">
data Context a = Context { cTime :: PTime,          cPlayer :: Player a
			 , cInst :: InstrumentName, cDur    :: DurT
			 , cPch  :: AbsPitch,       cVol    :: Volume
			 , cKey  :: (PitchClass, Mode)
			 }
data Player a = MkPlayer { pName        :: PlayerName   -- ID for selection
			 , playNote     :: NoteFun a    -- Interp. notes
			 , interpPhrase :: PhraseFun a  -- Interp. phrases
			 -- , notatePlayer :: NotateFun -- Removed.
			 }
		</pre>
		The PMap ("Player Map") mentioned above tells Euterpea which Player to use
		for which instrument.
		</div>
		<aside class="notes">
			<pre style="font-size: 32px; white-space: pre-line;"
			type Performance = [ Event ]
			data MEvent = MEvent { eTime, eInstr, ePitch, eDur, eVol, eParams :: [ Double ] }
							deriving (Show, Eq, Ord)
			perform :: PMap a -> Context a -> Music a -> Performance  -- See p. 138 of HSoM
			type NoteFun a = Context a -> Dur -> a -> Performance
			type PhraseFun a = PMap a -> Context a -> [PhraseAttribute] -> Music a -> (Performance, DurT)
			type NotateFun a = ()
			The PMap is a map from PlayerName (String) to Player (a means of rendering sound & score).
			type PMap a = PlayerName -> Player a
			There is a similar map for channels:
			type ChannelMap = [ (InstrumentName, Channel) ]
			type ChannelMapFun = InstrumentName -> ChannelMap -> (Channel, ChannelMap)
		</aside>
	</section>

	<section id="euterpea_phraseAttribute">
		<h3>Euterpea &mdash; A Simple Phrase Attribute</h3>
		<div style="text-align: left;">
		Let's look at a function to implement the core part
			of one of the simplest phrase attributes, Crescendo,
		which causes the volume of notes to grow over the lifetime of a phrase.
		The function defined below modifies the volume of each note
		(MEvent, actually) in a Performance, based on the timing of the note
		within the performance
		<pre style="font-size: 32px; " font-family="family-name:cursive;">
myPasHandler :: PhraseAttribute -> Performance -> Performance
myPasHandler (Dyn (Crescendo x)) pf = boostVolsBy x pf
    where t0 = eTime (head performance)
	perfDur :: Dur
	perfDur =  sum $ map eDur performance
	propTime :: PTime -> Rational
	propTime t = (t - t0) / perfDur
	propVolDelta :: PTime -> Rational
	propVolDelta t = x * (propTime t)
	newVol t v = round((1 + (propVolDelta t)) * (fromIntegral v))
	boostMEventVol (e@MEvent {eTime = t, eVol = v})
		= e { eVol = trace ("Vol=" ++ show (newVol t v))
				   (newVol t v)
		}
	boostVolsBy :: Rational -> [MEvent] -> [MEvent]
	boostVolsBy x pf = map boostMEventVol pf

myPasHandler pa                    pf = defPasHandler pa pf
		</pre>
		<aside class="notes">
		</aside>
	</section>

	<section id="euterpea_ragtimify">
		<h3>Euterpea &mdash; The "Ragtimify" Use Case</h3>
		<div style="text-align: left;">
		Ragtime pieces often have a baseline that alternates between chords and
		notes or pairs.  This gives the ragtime piece it's characteristic pulse.
			<div style="text-align: center;">
			<img src="http://ragpiano.com/misc/somesyn.gif"
				align="center"
				border="1"
				width="75%"/>
			</div>
		Suppose have a piece of music with chords in its baseline,
		and you want to have a Player output a ragtime version.
		Or you want to write a function that takes a Music argument
		and outputs a ragtime version.
		You might hope to first find the Chord objects by....
		<br/><br/>
		But if your music is written in Euterpea, there are no "Chord objects".
		Because of how Music is defined, the chords are not explicitly
		recorded as such.
		Instead, they're recorded as something like
		<pre style="font-size: 32px; " font-family="family-name:cursive;">
		(note1 :=: (note2 :=: (note3 :=: note4)
		</pre>
		So one drawback of the simplicity of the internal representation used
		is that extracting structure from the piece later becomes challenging.
		</div>
		<aside class="notes">
		</aside>
	</section>

	<section id="euterpea_soundscape">
		<h3>Euterpea &mdash; Creating Other Sounds</h3>
		<div style="text-align: left;">
		Euterpea also supports more general sound creation using Arrows (see Control.Arrow).
		<pre style="font-size: 32px; " font-family="family-name:cursive;">
(>>>) :: SF a b -> SF b c -> SF a c -- Left-to-right composition
(<<<) :: SF b c -> SF a b -> SF a c -- Right-to-left composition
z <- sigFunc -< (x, y)		    -- Signal function
		</pre>
		<pre style="font-size: 32px; " font-family="family-name:cursive;">
{-# LANGUAGE Arrows #-}
module Euterpea.Examples.SigFuns where
import Euterpea
import Control.Arrow ((>>>),(<<<),arr)

s4 :: Clock c => SigFun c () Double
s4 = proc () -> do
       f0  <- oscFixed 440   -< ()
       f1  <- oscFixed 880   -< ()
       f2  <- oscFixed 1320  -< ()
       outA -< (f0 + 0.5*f1 + 0.33*f2) / 1.83

vibrato ::   Clock c =>
             Double -> Double -> SigFun c Double Double
vibrato vfrq dep = proc afrq -> do
  vib  <- osc tab1  0 -< vfrq
  aud  <- osc tab2  0 -< afrq + vib * dep
  outA -< aud

s5 :: AudSF () Double
s5 = constA 1000 >>> vibrato 5 20
		</pre>
		<aside class="notes" />
	</section>

	<section id="euterpea_codingStandards">
	<h3>Euterpea &mdash; Some music coding standards</h3>
		<div style="text-align: left;">
		<ol>
		<li> <b>Represent compositions as concatenations of smaller sub-compositions ("pieces")
				in a regular way, such as by instrument and measure(s).</b>
			<ul>
				<li> Consider naming the pieces to reflect the structure of this decomposition.
				<ul>
					<li> E.g., sonata_violin_1_4 could contain measures 1 through 4.
				</ul>
				<li> If a piece contains multiple measures, consider putting each measure
					on a separate line.
				<li> Identify and extract duplicated subexpressions and other structures.
				<ul>
					<li> If the subexpression is associated with particular lyrics
						consider using the lyrics in the name of the variable.
				</ul>

				<li> Identify nearly-duplicated subexpressions, and use functions
					to extract the similarity.
			</ul>
		<br/>
		<li> <b>Perform validation tests:</b>
			<ul>
				<li> Validate that all pieces have the expected duration.
				<li> Validate that all expected instruments are present.
			</ul>
		<br/>
		<li> <b>Perform live testing:</b>
			<ul>
				<li> Listening to compositions will help detect some issues.
				<li> Play melodies in parallel to detect differences/intervals.
			</ul>
		<br/>
		<li> <b>Derive metrics to be used in testing:</b>
			<ul>
				<li> Just as images can be associated with color histograms,
					short segments of music can be associated (via FFTs) with frequency histograms.
			</ul>
		</ol>
		</div>
		<aside class="notes" />
	</section>

	<section id="euterpea_other">
		<h3>Euterpea &mdash; Other Info</h3>
		<div style="text-align: left;">
		<ul>
			<li> Chapter 17 of the PDF book Haskell School of Music introduces
				Arrow-based Functional Reactive Programming (FRP) via the library
				FRP.UISF.
			<ul>
				<li> A good place to learn more about it is
				Daniel Winograd-Cort's
				<a href="https://github.com/dwincort/UISF/tree/master/FRP/UISF/Examples">
				UISF Examples
				</a> on github.
			</ul>
			<li> Many other music programming languages have interfaces in Haskell,
				so there can be communication between them and Euterpea.
			<li> The
				<a href="http://music-suite.github.io/docs/api/">
				Haskell Music Suite
				</a>
				is based on Euterpea.
				It's pretty slick.
				It has a "back end" that supports printing tonal music via LilyPond,
					but does not support soundscapes.
		</ul>
		</div>
		<aside class="notes" />
	</section>
</section>

<section id="section_csound">
	<section id="csound">
		<h2 style="background-color: #d0d0ff;">
			<a href="#/section_euterpea">&#x25c1;</a>
			Csound
			<a href="#/section_chuck">&#x25b7;</a>
		</h2>
		<div style="text-align: left;">
		</div>
		<aside class="notes" />
	</section>

	<section id="csound_other">
		<h3>Csound &mdash; Other info</h3>
		<div style="text-align: left;">
		<ul>
		<li> <a href="http://blue.kunstmusik.com/">Blue</a>
			is a composition environment for Csound.
		</ul>
		</div>
		<aside class="notes" />
	</section>
</section>

<section id="section_chuck">
	<section id="chuck">
		<h2 style="background-color: #d0d0ff;">
			<a href="#/section_csound">&#x25c1;</a>
			ChucK
			<a href="#/section_puredata">&#x25b7;</a>
		</h2>
		<div style="text-align: left;">
		</div>
		<aside class="notes" />
	</section>

	<section id="chuck_hellosinewave">
		<h3>ChucK &mdash; Hello Sine Wave</h3>
		<div style="text-align: left;">
		ChucK sends audio to the speakers using a Digital-to-Audio Converter (DAC) denoted by dac.
			Here is a script that plays a 220 Hz sine wave for 5 seconds.
		<pre style="font-size: 32px;">
	<<< "Hello, sine wave" >>>
	SinOsc s => dac;
	0.6 => s.gain;
	220 => s.freq;
	5::second => now;
		</pre>
		In this script:
		<ul>
			<li> Stuff inside the guillemet-like quotes are evaluated and printed to the standard output.
			<li> SinOsc is a Sinusoidal Oscillator type, which has "gain" (i.e., volume) and "freq" (i.e., pitch) properties.
			<li> The '=>' symbol is called the "chuck" operator, since it "throws" or "chucks" a value or stream to its destination.
			<li> Sending a duration to "now" causes time to advance, which streams output to the dac, which creates sound.
		</ul>
		</div>
		<aside class="notes" />
	</section>

	<section id="chuck_moreinfo">
		<h3>ChucK &mdash; More Info</h3>
		<div style="text-align: left;">
		<ul>
			<li> Musical notes can be referenced by their MIDI Note Numbers, and converted to actual frequencies by Std.mtof().
			<li> A 3-note chord can be represented by an array of SinOsc objects: SinOsc chord[3];
			<li> ChucK uses the whimsical terms "shreds" and "spork" for processes and forks.
			<ul>
				<li> Scripted and compiled plug-ins are called Chugens and ChuGins.
			</ul>
			<li> To emulate rests, have time advance in a scope without audio streams.  Add notes in function calls.
			<li> Different instruments can be represented via different "shreds".  Events are used to communicate between shreds.
			<li> For stereo, dac has fields called .left and .right.  For quadraphonic sound, use the .chan field.
			<li> ChucK can be run in what I'll call "performance mode", where a script can be updated as it's running.
		</ul>
		</div>
		<aside class="notes" />
	</section>

	<section id="chuck_echo">
		<h3>ChucK &mdash; Echo Script</h3>
		<div style="text-align: left;">
		Here is a simple "echo" script that reads from a microphone,
			then echoes a slightly delayed and muted version to the speakers.  It uses a built-in Audio-to-Digital Converter (ADC) called adc. 
		<pre style="font-size: 32px;">
	// Feedback setup
	adc => Gain g => dac;
	g => Gain feedback => DelayL delay => g;

	0.75::second => delay.max => delay.delay;
	0.5 => feedback.gain;  // Note: gain < 1.
	0.75 => delay.gain;
	while (true) 1::second => now;
		</pre>
		</div>
		<aside class="notes" />
	</section>

	<section id="chuck_instrument">
		<h3>ChucK &mdash; Instrument Modeling</h3>
		<div style="text-align: left;">
		But wait, there's more!  ChucK doesn't just dutifully chuck data around.
		It also allows you to create physical models of the acoustics of instruments,
			such as a ceramic flute, an 18th century violin, or the human voice.
		(This functionality was copied from the earlier Synthesis ToolKit in C++.
		For more details on the modeling, see https://ccrma.stanford.edu/~jos/pas...)
		Here's a simplified version of a plucked string, modified from the book
			<a href="http://www.amazon.com/Programming-Musicians-Digital-Artists-Creating/dp/1617291706/">
				Programming for Musicians and Digital Arists: Creating music with ChucK
			</a>.
		<pre style="font-size: 32px;">
	// Karplus-Strong model of a plucked string
	Impulse imp => Delay plucked => dac;
	plucked => plucked;   // Feedback 
	441.0::samp => plucked.delay; // Sample rate
	0.98 => plucked.gain; // Round-trip gain < 1
	1.0 => imp.next;      // "Pluck" impulse
	5.0::second => now;   // The string resonates
		</pre>
		<ul>
			<li> Note the feedback line that connects plucked to itself.
					This reflects how the action of a plucked string is dependent
					on its action at previous moments in time.
		</ul>
		</div>
		<aside class="notes" />
	</section>

	<section id="chuck_other">
		<h3>ChucK &mdash; Other info</h3>
		<div style="text-align: left;">
		The Good &amp; The Bad
			<ul>
			<li> What ChucK does well: Signal processing and musical instrument acoustic modeling.
			<li> What ChucK doesn’t do as well: Programmatic expressiveness and musical expressiveness.
			<ul>
				<li> Programmatic exp.:
						There's no support for interfaces or higher-order functions, and it’s 2016!
				<li> Musical exp.:
						The language supports abstractions for audio streams,
						but not so much for melodic composition or analysis,
						which are critical for the capturing of many musical idioms.
						(Think of two jazz musicians speaking with each other in shorthand.
						Then again, what programming environment captures this well?)
						This shortcoming is partially addressed by some open source libraries on github
							(e.g., LiCK and Chuckery), but these can only go so far in addressing
							fundamental language limitations.
				</ul>
			</ul>
		</div>
		<aside class="notes" />
	</section>
</section>

<section id="section_overtone">
	<section id="overtone">
		<h2 style="background-color: #d0d0ff;">
			<a href="#/section_chuck">&#x25c1;</a>
			Overtone and Leipzig
			<a href="#/section_puredata">&#x25b7;</a>
		</h2>
		<div style="text-align: left;">
		Overtone is a lisp-like language that controls different oscillators.
		
		Here are some exerpts from the song "Tuesday", which can be found
		<a href="https://www.snip2code.com/Snippet/176938/Tuesday---written-with-Overtone-and-Leip">
		here
		</a>:
		<pre style="font-size: 32px;">
(definst metallia [freq 440 dur 1 volume 1.0]
    (-> (sin-osc freq (sin-osc 1))
	(+ (sin-osc (* 1/2 freq) (sin-osc 1/3)))
	(clip2 (mul-add (saw 1/4) 0.2 0.7))
	(* (env-gen (adsr 0.03 0.6 0.3) (line:kr 1 0 dur) :action FREE))
	(* 1/4 volume)))

(defn minor [chord] (update-in chord [:iii] (scale/from -1/2)))

(def melody
    (->>
	(phrase [2/3 13/3 5/3 9/3 1/3 2/3 13/3 2/3 13/3]
		[  1    2   1   0   0   1    2   3    0])
	(where :pitch scale/raise)
	(where :part (is :melody))))
		</pre>
		</div>
		<aside class="notes" />
	</section>
</section>

<section id="section_puredata">
	<section id="puredata">
		<h2 style="background-color: #d0d0ff;">
			<a href="#/section_chuck">&#x25c1;</a>
			Pure Data (Pd)
			<a href="#/section_supercollider">&#x25b7;</a>
		</h2>
		<div style="text-align: left;">
		</div>
		<aside class="notes" />
	</section>
</section>

<section id="section_supercollider">
	<section id="supercollider">
		<h2 style="background-color: #d0d0ff;">
			<a href="#/section_puredata">&#x25c1;</a>
			SuperCollider 3 (SC)
			<a href="#/section_strasheela">&#x25b7;</a>
		</h2>
		<div style="text-align: left;">
		</div>
		<aside class="notes" />
	</section>

	<section id="supercollider_language">
		<h3>SuperCollider &mdash; The Language</h3>
		<div style="text-align: left;">
		SuperCollider (named in 1993 after the cancelled Superconducting Super Collider project)
			is an OO language that supports GUI programming,
			with slightly differences between Windows, Mac, and Linux.
		It also supports plug-ins, a means of interactive programming, MIDI data,
			and communication with external devices.
		Functions are invoked via messages, as in Smalltalk.
		<pre style="font-size: 32px;">
	15.squared           // Evaluates to 225.
	[45, 13, 10].sort    // Evaluates to [10, 13, 45]
	5 pow: 8             // Same as 5.pow(8) 
	10.do({ "Hello world".postln })    // Writes to the "Post" pane.
		</pre>
		Caution: Binary operators are evaluated in strict left-to-right order,
			so 1 + 3 * 5 evaluates to 20, rather than 16.
		<br/><br/>
		Here is a brief code snippet that prints out the value of 5! ("five factorial"):
		<pre style="font-size: 32px;">
	var factorial = { | n |
		var result = 1;
		n do: { | i | result = result * (i + 1) };
		result;
	};
	factorial.(5).postln;
		</pre>
		<aside class="notes" />
	</section>

	<section id="supercollider_basics">
		<h3>SuperCollider &mdash; The Basics</h3>
		<div style="text-align: left;">
		SuperCollider has a client-server design, like IPython/Jupyter.
		The client's interpreter starts automatically.  A local audio server can be started with the command
		<pre style="font-size: 32px;">
		s.boot
		</pre>
		where the variable "s" is reserved to represent the server.
		Client-server synchronization is achieved via communication message tags
			with the intended time of execution in NTP (Network Time Protocol) format.
		<br/><br/>
		To execute a command in the IDE that comes with SC,
			highlight a section of code and type Ctrl-Enter.
		<br/><br/>
		The IDE's Help Browser is easy to use, though some entries have minimal information.
		<br/><br/>
		SuperCollider focus is on creating envelopes of sound with signal processing,
			and combining them with a family of "pattern" classes (e.g., Pbind, Pchain, Prand, etc.).
			While it's theoretically possible to emulate specific musical instruments (e.g., piano, guitar, etc.)
			in SuperCollider, it isn't commonly done.
		</div>
	</section>

	<section id="supercollider_sinewaves">
		<h3>SuperCollider &mdash; Sine Waves</h3>
		<div style="text-align: left;">
		A (non-terminating) sine wave at 440 Hz can be played at half-volume with
		<pre style="font-size: 32px; white-space: pre-line;">
		{ SinOsc.ar(440, phase: 0, mul: 0.5, add: 0) }.play;  // using keyword args
		or
		{ SinOsc.ar(440, 0, 0.5, 0) }.play;  // using positional args
		or just
		{ SinOsc.ar(440) }.play;  // omitting arguments with default values
		</pre>
		where "ar" is the "audio rate" constructor of the SinOsc class.
		The sine wave can be stopped with Ctrl-<period>.
		All the parameters above can be omitted, which will cause default values to be used.
		An important class to become familiar with is UGen, the abstract superclass of all "unit generators".
		These are classes that represent signals.  Examples include:
		<ul>
			<li> Impulse, a class that represents a simple sound;
			<li> LFSaw, a class that represents a low-frequency sawtooth oscillator (cf. SinOsc);
			<li> PMOsc, a class that represents a phase modulation oscillator (cf. SinOsc);
			<li> EnvGen, which wraps another signal with an "envelope";
			<li> Latch, which wraps another signal with an all-or-nothing filter.
		</ul>
		</div>
		<aside class="notes" />
	</section>

	<section id="supercollider_complex">
		<h3>SuperCollider &mdash; A More Complex Example</h3>
		<div style="text-align: left;">
		Lastly, here is a short piece that creates a cascade of random pitches
			that varies more quickly when the mouse is moved to the right-hand side of the IDE window.
		<pre style="font-size: 32px; ">
{
	var freq, latchrate, index, ratio, env, speed = 9;
	speed = MouseX.kr(2, 20);
	latchrate = speed * 1.61803399;
	index = Latch.kr(
		LFSaw.kr(latchrate, mul: 4, add: 8),
		Impulse.kr(speed)
	);
	freq = Latch.kr(
		LFSaw.kr(latchrate, mul: 36, add: 60),
		Impulse.kr(speed)
	).round(1).midicps;
	ratio = 2.01;
	env = EnvGen.kr(Env.perc(0, 2/speed), gate: Impulse.kr(speed));
	Out.ar(0, PMOsc.ar([freq, freq * 1.5],
		[freq * ratio, freq * 1.5 * ratio],
		index,
		mul: env * 0.5)
)}.play
		</pre>
		</div>
		<aside class="notes">
		When SC was named, the SSC had recently been cancelled by a budget cut.
		The musical language SuperCollider (SC) had a similarly grand vision
			(real-time music synthesis within a garbage-collected language),
			and its creater was skeptical of its long-term success.
		Luckily, SuperCollider has enjoyed greater success than its physics namesake.
		SuperCollider has a bunch of basic types (Integer, Float, Char, String, Symbol,
			Point, Array, Event, Function)
		</aside>
	</section>
</section>

<section id="section_strasheela">
	<section id="strasheela">
		<h2 style="background-color: #d0d0ff;">
			<a href="#/section_supercollider">&#x25c1;</a>
			Strasheela (Honorable Mention)
			<a href="#/section_resources">&#x25b7;</a>
		</h2>
		<div style="text-align: left;">
		Strasheela is a music programming language that lets the user describe constraints
		(rhythmic, melodic, and harmonic) on a music composition
		(and "containers" defined therein),
		and then Strasheela finds one or more compositions that satisfies these constraints,
		presuming that they are satisfiable.
		<br/><br/>
		After calling 
		<a href="http://strasheela.sourceforge.net/strasheela/doc/api/node6.html#entity378">
		Score.makeScore
		</a>,
		the output can be rendered with a choice of formats, including
		LilyPond, Csound, SuperCollider, or Common Lisp Music (CLM).
		<br/><br/>
		Strasheela was writting by Torsten Anders for his dissertation,
		and was last modified in 2012. 
		It's implemented in the constraint-based programming language, Oz,
		which is similar to Prolog.
		(The theme of "Oz" provides the name "Strasheela"
		&mdash;
		it's the name of the Scarecrow in the Russian version of The Wizard of Oz.)
		</div>
		<aside class="notes" >
		Score constructors, score accessors, score transformers.
		Predefined constraints.
		Has a data type called finite domain (FD) integers.
		</aside>
	</section>

	<section id="strasheela_constraints">
		<h3>Strasheela &mdash; Constraints</h3>
		<div style="text-align: left;">
			Here is an example from a
			<a href="http://cmr.soc.plymouth.ac.uk/tanders/publications/TorstenAnders-MOZ2004.pdf">
			2004 paper
			</a>
			of a constraint in Strasheela called RestrictMelodicInterval
			that requires that consecutive notes be separated by no more than a
			perfect fifth (which equals 7 semitones).
			<pre style="font-size: 32px;">
proc {RestrictMelodicInterval Note1}
    Note2 = {Note1 getTimeAspectPredecessor($)}
in
    7 >=: {FD.distance {Note1 getPitch($)} {Note2 getPitch($)}}
end
			</pre>
			and here is this rule being applied:
			<pre style="font-size: 32px;">
{MyScore
    forAll(RestrictMelodicInterval
	test:fun {$ X}
	    {X isNote($)} andthen
	    {X hasTimeAspectPredecessor($)}
    end)}
}
			</pre>
			A typical Strasheela program can use hundreds of constraints and 
			constrained variables.  The order in which the constraits are applied
			matters, with the order typically being
			Timing &rArr; Melodic &rArr; Harmonic.
			A user starting out should gradually increase the number of constraints
			to determine their impact on program execution time.
		</div>
		<aside class="notes">
		</aside>
	</section>

	<section id="strasheela_canons">
		<h3>Strasheela &mdash; Canons</h3>
		<div style="text-align: left;">
			In music, a <em>canon</em> is a piece of music in which two or more voices
			play the same music, starting at different times.  Classic examples include
			"Row, Row, Row Your Boat" and "Frère Jacques".  If there are other voices
			that do not share in the repetition, then it's called an
			"<em>accompanied canon</em>".
			<br/><br/>
			Here's a short canon found in a few seconds by Strasheela
			(from sourceforge.net)
			[<a href="http://strasheela.sourceforge.net/strasheela/examples/Output/03-FloridCounterpoint-Canon.mp3">play</a>]:
			<img src="http://strasheela.sourceforge.net/strasheela/examples/Output/03-FloridCounterpoint-Canon.preview.png"
				border="1"
				width="100%"/>
		</div>
		<aside class="notes">
		</aside>
	</section>

	<section id="strasheela_moreInfo">
		<h3>Strasheela &mdash; More Info</h3>
		<div style="text-align: left;">
			<ul>
				<li> Oz &amp; Efficiency of search.
				<li> Constraint Leniency
				<li> Limitations
				<ul>
					<li> Strasheela does not readily support microtonal music.
						(The pitches would best be represented by fractions or real numbers,
						by Oz uses integer arithmetic.)
				</ul>
			</ul>
			<pre style="font-size: 32px;">
			</pre>
		</div>
		<aside class="notes">
		</aside>
	</section>
</section>

<section id="section_resources">
	<section id="resources">
		<h2 style="background-color: #d0d0ff;">
			<a href="#/section_strasheela">&#x25c1;</a>
			Resources
			<a href="#/title">&#x25b7;</a>
		</h2>
		<div style="text-align: left;">
		<ol>
		<li> Music Theory
		  <ul>
			<li> <a href=http://www.amazon.com/Jazz-Theory-Book-Mark-Levine/dp/1883217040">
				The Jazz Theory Book
				</a>, by Mark Levine
			<li> <a href="http://postmodernjukebox.com/courses/Ragtimify.pdf">
				Ragtimify
				</a>
				a book on converting scores to Ragtime
			<li> Sheet music: 
				<a href="http://www.bandmusicpdf.org/">
					Band music
				</a>,
				<a href="http://imslp.org/wiki/">
					International Music Score Library Project
				</a>,
				<a href="http://www.gutenberg.org/browse/categories/4">
					Project Gutenberg
				</a>
			<li> <a href="http://bach.nau.edu/clavier/nature/fugues/Fugue02.html">
					Visualization of music by Bach and others
				</a>
		  </ul>
		<li> Music Programming:
		  <ul>
			<li> <a href="http://www.mat.ucsb.edu/res_proj7.php">
				Sonification of the cosmic microwave background
				</a>
		  </ul>
		<li> Colophon:
		  <ul>
			<li> <a href="https://github.com/hakimel/reveal.js">
				reveal.js source code &amp; documentation
				</a>
		  </ul>
		</div>
		<aside class="notes" />
	</section>
</section>

</div> <!-- slides -->
</div> <!-- reveal -->

<script>
	// Full list of configuration options available at:
	// https://github.com/hakimel/reveal.js#configuration
	Reveal.initialize({
		controls: true,
		progress: true,
		history: true,
		center: false,
		transition: 'slide', // none/fade/slide/convex/concave/zoom

		// Optional reveal.js plugins
		dependencies: [
			{ src: 'js/classList.js', condition: function() { return !document.body.classList; } },
			{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
			{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
			{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
			{ src: 'plugin/zoom-js/zoom.js', async: true },
			{ src: 'plugin/notes/notes.js', async: true }
		]
	});
</script>
</body>
</html>

<!-- Euterpea notes:
			<pre sytle="font-size: 32px;">
			playA :: (ToMusic1 a, Control.DeepSeq.NFData a)
					=> PMap Note1 -> Context Note1 -> Music a -> IO ()
					(This calls playC)
			playC :: (ToMusic1 a, Control.DeepSeq.NFData a)
					=> PlayParams -> Music a -> IO ()
					(This calls playStrict or playInf)
			playStrict :: (ToMusic1 a, NFData a)
					=> PlayParams -> Music a -> IO ()
			playStrict p m = m `deepseq`
				let x = toMidi (perfAlg p $ toMusic1 m)
				in x `deepseq` playM' (devID p) x
					(So this calls toMusic1, toMidi, and playM')
			toMusic1 :: Music a -> Music1
				has instances for: Pitch, (Pitch, Volume), Note1, AbsPitch
			toMidi:: [MEvent] -> Midi
			toMidi = toMidiUPM defUpm
			toMidiUPM :: UserPatchMap -> [MEvent] -> Midi
			playM' :: Maybe OutputDeviceID -> Midi -> IO ()
					(This calls playMidi)
			data Midi = Midi { fileType :: FileType}
							 , timeDiv :: TimeDiv
							 , tracks :: [Track Ticks]
							 }
			playMidi :: OutputDeviceID -> Midi -> IO ()
			type MidiEvent = (Time, MidiMessage)
			data MidiMessage = ANote { channel :: !Channel
									 , key :: !Key
									 , velocity :: !Velocity
									 , duration :: !Time
									 }
							 | Std Message
			type MidiEvent = (Time, MidiMessage)
			</pre>
-->

<!-- reveal.js notes:
	Setting up reveal.js:
		http://htmlcheats.com/reveal-js/reveal-js-tutorial-reveal-js-for-beginners/
	Code formatting:
		<pre><code class="hljs" data-trim contenteditable>
		</code></pre>
	Fragments:
		<p class="fragment">one fragment</p>
		<span class="fragment">another</span>
	JavaScript API:
		https://github.com/hakimel/reveal.js#api
	Links to other slides:
		<section id="languages">
		<a href="#/languages">like this</a>
	Markdown:
		Guidelines for reveal.js at https://github.com/hakimel/reveal.js#markdown
		<section data-markdown>
			<script type="text/template">
	Quote templates
		Inline: <q cite="http://foo/bar/baz.html">&ldquo; Lorem ipsum &rdquo;</q>
		Blockquote:
			<blockquote cite="http://foo/bar/baz.html">
				&ldquo; Lorem ipsum .&rdquo;
			</blockquote>
	State:
		Global state:
			Setting data-state="foo" on a slide => "foo" is added as a class to the doc element on open.
		Events:
			See documentation.
	Style changes
		style="font-size: 72px;"
-->
